<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><title>Getting started · RAD Modules</title><meta name="viewport" content="width=device-width"/><meta name="generator" content="Docusaurus"/><meta name="description" content="## Scheduler step by step"/><meta name="docsearch:language" content="en"/><meta property="og:title" content="Getting started · RAD Modules"/><meta property="og:type" content="website"/><meta property="og:url" content="https://thesoftwarehouse.github.io/rad-modules-docs/"/><meta property="og:description" content="## Scheduler step by step"/><meta property="og:image" content="https://thesoftwarehouse.github.io/rad-modules-docs/img/undraw_online.svg"/><meta name="twitter:card" content="summary"/><link rel="shortcut icon" href="/rad-modules-docs/img/favicon.ico"/><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/atom-one-dark.min.css"/><script type="text/javascript" src="https://buttons.github.io/buttons.js"></script><script src="/rad-modules-docs/js/scrollSpy.js"></script><link rel="stylesheet" href="/rad-modules-docs/css/main.css"/><script src="/rad-modules-docs/js/codetabs.js"></script></head><body class="sideNavVisible separateOnPageNav"><div class="fixedHeaderContainer"><div class="headerWrapper wrapper"><header><a href="/rad-modules-docs/"><img class="logo" src="/rad-modules-docs/img/favicon.ico" alt="RAD Modules"/><h2 class="headerTitleWithLogo">RAD Modules</h2></a><div class="navigationWrapper navigationSlider"><nav class="slidingNav"><ul class="nav-site nav-site-internal"><li class=""><a target="_self"></a></li><li class=""><a href="https://github.com/TheSoftwareHouse" target="_self">GitHub</a></li></ul></nav></div></header></div></div><div class="navPusher"><div class="docMainWrapper wrapper"><div class="docsNavContainer" id="docsNav"><nav class="toc"><div class="toggleNav"><section class="navWrapper wrapper"><div class="navBreadcrumb wrapper"><div class="navToggle" id="navToggler"><div class="hamburger-menu"><div class="line1"></div><div class="line2"></div><div class="line3"></div></div></div><h2><i>›</i><span>Scheduler</span></h2><div class="tocToggler" id="tocToggler"><i class="icon-toc"></i></div></div><div class="navGroups"><div class="navGroup"><h3 class="navGroupCategoryTitle">Documentation</h3><ul class=""><li class="navListItem"><a class="navItem" href="/rad-modules-docs/docs/">Getting started</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Changelog</h3><ul class=""><li class="navListItem"><a class="navItem" href="/rad-modules-docs/docs/changelog">Details</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Security</h3><ul class=""><li class="navListItem"><a class="navItem" href="/rad-modules-docs/docs/security/security-index">Introduction</a></li><li class="navListItem"><a class="navItem" href="/rad-modules-docs/docs/security/security-getting-started">Getting started</a></li><li class="navListItem"><a class="navItem" href="/rad-modules-docs/docs/security/security-api-documentation">Api documentation</a></li><li class="navListItem"><a class="navItem" href="/rad-modules-docs/docs/security/security-advanced-configuration">Advanced configuration</a></li><li class="navListItem"><a class="navItem" href="/rad-modules-docs/docs/security/security-abac">Attribute-based access control</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Mailer</h3><ul class=""><li class="navListItem"><a class="navItem" href="/rad-modules-docs/docs/mailer/mailer-index">Introduction</a></li><li class="navListItem"><a class="navItem" href="/rad-modules-docs/docs/mailer/mailer-getting-started">Getting started</a></li><li class="navListItem"><a class="navItem" href="/rad-modules-docs/docs/mailer/mailer-api-documentation">Api documentation</a></li><li class="navListItem"><a class="navItem" href="/rad-modules-docs/docs/mailer/mailer-advanced-configuration">Advanced configuration</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Notifications</h3><ul class=""><li class="navListItem"><a class="navItem" href="/rad-modules-docs/docs/notifications/notifications-index">Notifications service</a></li><li class="navListItem"><a class="navItem" href="/rad-modules-docs/docs/notifications/notifications-details">Details</a></li><li class="navListItem"><a class="navItem" href="/rad-modules-docs/docs/notifications/notifications-api-documentation">Api documentation</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Serverless functions</h3><ul class=""><li class="navListItem"><a class="navItem" href="/rad-modules-docs/docs/serverless/serverless-index">Details</a></li><li class="navListItem"><a class="navItem" href="/rad-modules-docs/docs/serverless/serverless-create">Create file</a></li><li class="navListItem"><a class="navItem" href="/rad-modules-docs/docs/serverless/serverless-files">Get files</a></li><li class="navListItem"><a class="navItem" href="/rad-modules-docs/docs/serverless/serverless-delete">Delete file</a></li><li class="navListItem"><a class="navItem" href="/rad-modules-docs/docs/serverless/serverless-resize">Resize images</a></li><li class="navListItem"><a class="navItem" href="/rad-modules-docs/docs/serverless/serverless-watermark">Watermark</a></li><li class="navListItem"><a class="navItem" href="/rad-modules-docs/docs/serverless/serverless-rad-is-authenticated">RAD is authenticated</a></li><li class="navListItem"><a class="navItem" href="/rad-modules-docs/docs/serverless/serverless-pipeline">Bitbucket pipelines</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Scheduler</h3><ul class=""><li class="navListItem"><a class="navItem" href="/rad-modules-docs/docs/scheduler/scheduler-index">Introduction</a></li><li class="navListItem navListItemActive"><a class="navItem" href="/rad-modules-docs/docs/scheduler/scheduler-getting-started">Getting started</a></li><li class="navListItem"><a class="navItem" href="/rad-modules-docs/docs/scheduler/scheduler-api-documentation">Api documentation</a></li><li class="navListItem"><a class="navItem" href="/rad-modules-docs/docs/scheduler/scheduler-advanced-configuration">Advanced configuration</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Pdf generator</h3><ul class=""><li class="navListItem"><a class="navItem" href="/rad-modules-docs/docs/pdf-generator/pdf-index">Introduction</a></li><li class="navListItem"><a class="navItem" href="/rad-modules-docs/docs/pdf-generator/pdf-getting-started">Getting started</a></li><li class="navListItem"><a class="navItem" href="/rad-modules-docs/docs/pdf-generator/pdf-api-documentation">Api documentation</a></li><li class="navListItem"><a class="navItem" href="/rad-modules-docs/docs/pdf-generator/pdf-advanced-configuration">Advanced configuration</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Admin panel</h3><ul class=""><li class="navListItem"><a class="navItem" href="/rad-modules-docs/docs/admin-panel/admin-panel-index">Details</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Services communication</h3><ul class=""><li class="navListItem"><a class="navItem" href="/rad-modules-docs/docs/communication-between-services">Communication between services</a></li></ul></div></div></section></div><script>
            var coll = document.getElementsByClassName('collapsible');
            var checkActiveCategory = true;
            for (var i = 0; i < coll.length; i++) {
              var links = coll[i].nextElementSibling.getElementsByTagName('*');
              if (checkActiveCategory){
                for (var j = 0; j < links.length; j++) {
                  if (links[j].classList.contains('navListItemActive')){
                    coll[i].nextElementSibling.classList.toggle('hide');
                    coll[i].childNodes[1].classList.toggle('rotate');
                    checkActiveCategory = false;
                    break;
                  }
                }
              }

              coll[i].addEventListener('click', function() {
                var arrow = this.childNodes[1];
                arrow.classList.toggle('rotate');
                var content = this.nextElementSibling;
                content.classList.toggle('hide');
              });
            }

            document.addEventListener('DOMContentLoaded', function() {
              createToggler('#navToggler', '#docsNav', 'docsSliderActive');
              createToggler('#tocToggler', 'body', 'tocActive');

              var headings = document.querySelector('.toc-headings');
              headings && headings.addEventListener('click', function(event) {
                var el = event.target;
                while(el !== headings){
                  if (el.tagName === 'A') {
                    document.body.classList.remove('tocActive');
                    break;
                  } else{
                    el = el.parentNode;
                  }
                }
              }, false);

              function createToggler(togglerSelector, targetSelector, className) {
                var toggler = document.querySelector(togglerSelector);
                var target = document.querySelector(targetSelector);

                if (!toggler) {
                  return;
                }

                toggler.onclick = function(event) {
                  event.preventDefault();

                  target.classList.toggle(className);
                };
              }
            });
        </script></nav></div><div class="container mainContainer docsContainer"><div class="wrapper"><div class="post"><header class="postHeader"><h1 id="__docusaurus" class="postHeaderTitle">Getting started</h1></header><article><div><span><h2><a class="anchor" aria-hidden="true" id="scheduler-step-by-step"></a><a href="#scheduler-step-by-step" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Scheduler step by step</h2>
<p>To start playing with the scheduler service you need:</p>
<ol>
<li>The internet connection (only to pull docker images from <a href="https://hub.docker.com/r/tshio/scheduler">dockerhub</a>)</li>
<li>Installed docker and docker-compose (optional but it will save you a lot of time)</li>
</ol>
<p>After that please follow steps:</p>
<ol>
<li>Create a catalog where we will be playing with the mailer service:</li>
</ol>
<pre><code class="hljs css language-text">mkdir scheduler-service-playground
</code></pre>
<ol start="2">
<li>Go to the catalog:</li>
</ol>
<pre><code class="hljs css language-text">cd scheduler-service-playground
</code></pre>
<ol start="3">
<li>Create docker-compose.yml:</li>
</ol>
<pre><code class="hljs css language-text">touch docker-compose.yml
</code></pre>
<ol start="4">
<li>Open docker-compose.yml:</li>
</ol>
<pre><code class="hljs css language-text"> open -e docker-compose.yml
</code></pre>
<ol start="5">
<li>Copy and paste the example service configuration and save the file</li>
</ol>
<pre><code class="hljs css language-dockerfile">version: <span class="hljs-string">"3.7"</span>

services:
  api:
    container_name: api
    build:
      context: ./api
      dockerfile: Dockerfile
    volumes:
      - <span class="hljs-string">"./api:/app"</span>
      - <span class="hljs-string">"/app/node_modules"</span>
    ports:
      - <span class="hljs-string">"30003:30003"</span>
    depends_on:
      - scheduler
    networks:
      - app

  scheduler:
    image: tshio/scheduler:latest
    working_dir: /app/build/services/scheduler
    command: <span class="hljs-string">"api"</span>
    volumes:
      - ./cron/manifest.json:/app/build/services/scheduler/src/config/external-manifest.json
    hostname: scheduler
    ports:
      - <span class="hljs-number">50070</span>:<span class="hljs-number">50050</span>
    depends_on:
      - redis
    networks:
      - app

  redis:
    image: redis:<span class="hljs-number">4</span>-alpine
    hostname: redis
    networks:
      - app

networks:
  app:
</code></pre>
<ol start="6">
<li>Let's add simple web API to our workspace so we will be able to call some API methods from the scheduler</li>
</ol>
<ul>
<li>Create API catalog</li>
</ul>
<pre><code class="hljs css language-text"> mkdir api && cd api
</code></pre>
<ul>
<li>Add <code>package.json</code> file</li>
</ul>
<pre><code class="hljs css language-text"> touch package.json
</code></pre>
<ul>
<li>Add <code>package.json</code> information</li>
</ul>
<pre><code class="hljs css language-javascript"> {
  <span class="hljs-string">"name"</span>: <span class="hljs-string">"api"</span>,
  <span class="hljs-string">"version"</span>: <span class="hljs-string">"1.0.0"</span>,
  <span class="hljs-string">"description"</span>: <span class="hljs-string">""</span>,
  <span class="hljs-string">"main"</span>: <span class="hljs-string">"index.js"</span>,
  <span class="hljs-string">"scripts"</span>: {
    <span class="hljs-string">"test"</span>: <span class="hljs-string">"echo \"Error: no test specified\" &amp;&amp; exit 1"</span>,
    <span class="hljs-string">"watch"</span>: <span class="hljs-string">"node-dev server.js"</span>
  },
  <span class="hljs-string">"keywords"</span>: [],
  <span class="hljs-string">"author"</span>: <span class="hljs-string">""</span>,
  <span class="hljs-string">"license"</span>: <span class="hljs-string">"ISC"</span>,
  <span class="hljs-string">"dependencies"</span>: {
    <span class="hljs-string">"cors"</span>: <span class="hljs-string">"^2.8.5"</span>,
    <span class="hljs-string">"express"</span>: <span class="hljs-string">"^4.17.1"</span>,
    <span class="hljs-string">"node-fetch"</span>: <span class="hljs-string">"^2.6.0"</span>
  },
  <span class="hljs-string">"devDependencies"</span>: {
    <span class="hljs-string">"node-dev"</span>: <span class="hljs-string">"^4.0.0"</span>
  }
}
</code></pre>
<ul>
<li>Install <code>package.json</code> dependencies</li>
</ul>
<pre><code class="hljs css language-text">npm install
</code></pre>
<ul>
<li>Add <code>server.js</code> file</li>
</ul>
<pre><code class="hljs css language-text">touch server.js
</code></pre>
<ul>
<li>Add code to <code>server.js</code></li>
</ul>
<pre><code class="hljs css language-javascript"><span class="hljs-keyword">const</span> express = <span class="hljs-built_in">require</span>(<span class="hljs-string">"express"</span>);
<span class="hljs-keyword">const</span> fetch = <span class="hljs-built_in">require</span>(<span class="hljs-string">"node-fetch"</span>);
<span class="hljs-keyword">const</span> cors = <span class="hljs-built_in">require</span>(<span class="hljs-string">"cors"</span>);

<span class="hljs-keyword">const</span> app = express();
app.use(cors());
app.use(express.json());

<span class="hljs-keyword">const</span> port = <span class="hljs-number">30003</span>;

app.post(<span class="hljs-string">"/api/schedule-job"</span>, <span class="hljs-keyword">async</span> (req, res) =&gt; {
  <span class="hljs-keyword">try</span> {
    <span class="hljs-keyword">const</span> { body } = req;
    fetch(<span class="hljs-string">"http://scheduler:50050/api/scheduling/schedule-job"</span>, {
      <span class="hljs-attr">method</span>: <span class="hljs-string">"post"</span>,
      <span class="hljs-attr">headers</span>: { <span class="hljs-string">"Content-Type"</span>: <span class="hljs-string">"application/json"</span> },
      <span class="hljs-attr">body</span>: <span class="hljs-built_in">JSON</span>.stringify(body),
    });
  } <span class="hljs-keyword">catch</span> (err) {
    <span class="hljs-built_in">console</span>.error(err);
    res.sendStatus(<span class="hljs-number">500</span>);
  }

  res.sendStatus(<span class="hljs-number">200</span>);
});

app.post(<span class="hljs-string">"/api/test-scheduler"</span>, <span class="hljs-keyword">async</span> (req, res) =&gt; {
  <span class="hljs-keyword">try</span> {
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"TEST-SCHEDULER"</span>);
  } <span class="hljs-keyword">catch</span> (err) {
    <span class="hljs-built_in">console</span>.error(err);
    res.sendStatus(<span class="hljs-number">500</span>);
  }

  res.sendStatus(<span class="hljs-number">200</span>);
});

app.listen(port, () =&gt; <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`App listening on <span class="hljs-subst">${port}</span>`</span>));
</code></pre>
<ol start="7">
<li>In <code>api</code> catalog add <code>Dockerfile</code></li>
</ol>
<pre><code class="hljs css language-dockerfile"><span class="hljs-keyword">FROM</span> node:<span class="hljs-number">12.2</span>.<span class="hljs-number">0</span>-alpine

<span class="hljs-keyword">WORKDIR</span><span class="bash"> /app</span>

<span class="hljs-keyword">ENV</span> PATH /app/node_modules/.bin:$PATH

<span class="hljs-keyword">COPY</span><span class="bash"> package.json /app/package.json</span>
<span class="hljs-keyword">RUN</span><span class="bash"> npm install --silent</span>

<span class="hljs-keyword">CMD</span><span class="bash"> [<span class="hljs-string">"npm"</span>, <span class="hljs-string">"run"</span>, <span class="hljs-string">"watch"</span>]</span>
</code></pre>
<ol start="8">
<li>Go to workspace root and create <code>cron</code> catalog and <code>manifest.json</code> file in it.</li>
</ol>
<pre><code class="hljs css language-text"> mkdir cron && cd cron
</code></pre>
<pre><code class="hljs css language-text"> touch manifest.json
</code></pre>
<ol start="9">
<li>In the manifest file, we will put information about actions that the scheduler can call:</li>
</ol>
<ul>
<li><code>name</code> prop describe the name of service with should be called by the scheduler service,</li>
<li><code>url</code> describes where the service with should be called is host,</li>
<li><code>actions</code> describe with actions can be called in the service.</li>
<li><code>type</code> the action that name.</li>
</ul>
<p>So sample manifest.json file should look like e.g.</p>
<pre><code class="hljs css language-javascript"> [
  {
    <span class="hljs-string">"url"</span>: <span class="hljs-string">"http://api:30003"</span>,
    <span class="hljs-string">"name"</span>: <span class="hljs-string">"api"</span>,
    <span class="hljs-string">"actions"</span>: [
      {
        <span class="hljs-string">"type"</span>: <span class="hljs-string">"test-scheduler"</span>,
        <span class="hljs-string">"http"</span>: {
          <span class="hljs-string">"uri"</span>: <span class="hljs-string">"api/test-scheduler"</span>,
          <span class="hljs-string">"method"</span>: <span class="hljs-string">"POST"</span>
        }
      }
    ]
  }
]
</code></pre>
<ol start="10">
<li><p>Project structure should look like bellow:
<img src="/rad-modules-docs/docs/assets/scheduler/project-structure.png" alt="alt text"></p></li>
<li><p>Run docker-compose:</p></li>
</ol>
<pre><code class="hljs css language-text"> docker-compose up
</code></pre>
<ol start="12">
<li>Now, if everything is running, we can schedule a job. In our app, I created an endpoint with will display TEST-SCHEDULER in the console. So if we want the scheduler will call that endpoint every minute we need to create job by requesting scheduler API (we can use swagger endpoint or use our endpoint in the app I will use our endpoint). Request the endpoint with tool you like.</li>
</ol>
<pre><code class="hljs css language-text"> POST: localhost:30003/api/schedule-job
 Body:
 {
    "action": "test-scheduler",
    "service": "api",
    "cron": "*/1 * * * *"
 }
</code></pre>
<p>After that you should see TEST-SCHEDULER every minute in your console.</p>
<h2><a class="anchor" aria-hidden="true" id="how-to-cancel-scheduled-job"></a><a href="#how-to-cancel-scheduled-job" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>How to cancel scheduled job?</h2>
<p>Coming soon.</p>
</span></div></article></div><div class="docs-prevnext"><a class="docs-prev button" href="/rad-modules-docs/docs/scheduler/scheduler-index"><span class="arrow-prev">← </span><span>Introduction</span></a><a class="docs-next button" href="/rad-modules-docs/docs/scheduler/scheduler-api-documentation"><span>Api documentation</span><span class="arrow-next"> →</span></a></div></div></div><nav class="onPageNav"><ul class="toc-headings"><li><a href="#scheduler-step-by-step">Scheduler step by step</a></li><li><a href="#how-to-cancel-scheduled-job">How to cancel scheduled job?</a></li></ul></nav></div><footer class="nav-footer" id="footer"><section class="sitemap"><a href="/rad-modules-docs/" class="nav-home"><img src="/rad-modules-docs/img/favicon.ico" alt="RAD Modules" width="66" height="58"/></a><div><h5>Docs</h5><a href="https://thesoftwarehouse.github.io/rad-modules-docs/docs/">Getting started</a><a href="https://thesoftwarehouse.github.io/rad-modules-docs/docs/changelog">Changelog</a><a href="https://thesoftwarehouse.github.io/rad-modules-api-docs/">RAD Modules API Doc</a></div><div><h5>Services</h5><a href="https://thesoftwarehouse.github.io/rad-modules-docs/docs/security-index">Security</a><a href="https://thesoftwarehouse.github.io/rad-modules-docs/docs/mailer-index">Mailer</a><a href="https://thesoftwarehouse.github.io/rad-modules-docs/docs/notifications-index">Notifications</a><a href="https://thesoftwarehouse.github.io/rad-modules-docs/docs/serverless-index">Serverless functions</a><a href="https://thesoftwarehouse.github.io/rad-modules-docs/docs/scheduler-index">Scheduler</a><a href="https://thesoftwarehouse.github.io/rad-modules-docs/docs/pdf-index">Pdf generator</a><a href="https://thesoftwarehouse.github.io/rad-modules-docs/docs/rad-admin-panel-index">Admin panel</a></div><div><h5>Support:</h5><a href="https://github.com/TheSoftwareHouse/rad-modules-docs">GitHub</a><a href="mailto:hello@tsh.io">hello@tsh.io</a></div></section><section class="copyright">Copyright © 2020 The Software House</section></footer></div></body></html>